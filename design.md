# 需求概述
我想制作一个网页，用来给一个游戏内的角色技能释放进行时间轴排序，并自动按照游戏内的伤害计算规则进行伤害计算。

## 通用概念
为了显示信息以及进行计算，需要对显示信息和一些相关概念进行定义，包括了如下内容

### 角色信息
每一个角色有一组角色信息，通过配置文件读取，其中一部分可以在玩家选择角色时进行修改。
角色信息具体包括如下内容，其中允许在选择时动态修改的数据会进行标注
- 角色名称
- 角色职业
- 角色数值
    - 攻击力
    - 防御力
    - 生命值
    - 属性（包括力量、敏捷、智识、意志，四种属性）
- 主属性和副属性（主属性为力量、敏捷、智识、意志四种属性中的一种，副属性为另外三种属性中的一种）
- 角色技能
    - 每个角色有普通攻击、战技、连携技、终结技，这四种类型的技能各一个
- 角色等级：
    - 可动态修改的数据，上限为99
    - 角色等级影响角色的一系列动态数据，每个等级对应一组数据映射，包括：
        - 攻击力
        - 防御力
        - 生命值
        - 属性
    - 等级和属性的映射可参见data/character/attr文件夹中的所有csv，每个csv对应一个角色
- 角色天赋：
    - 一些可激活的天赋节点，可以选择是否激活启用
    - 部分天赋会提供角色数值加成，包括：
        - 攻击力
        - 防御力
        - 生命值
        - 属性
    - 部分天赋会添加一些触发类效果，在技能的生效节点，根据生效行为或生效时的目标或自身状态，执行一些额外行为
- 角色潜能：
    - 每个角色有潜能等级，上限为5，在选择角色时可以动态修改
    - 每个潜能等级对应一个效果，包括了数值修改和触发类效果

### 技能
技能是角色收到指令后，根据判断条件执行的动作行为
技能本质是一组数据，其本身并不执行行为
伤害计算和UI显示会根据技能内的信息，来进行相关显示，并设置或更新角色和敌人状态以及一些动态数据，并用于进行伤害计算

一个技能包含的数据有如下这些：
- 技能ID，用于查找索引
- 技能名称，用于显示的唯一名称，显示在skill palette和时间轴上的名称
- 技能类型，决定该技能在skill palette上所属的行为；后续扩展时会用于关联玩家按键操作显示，目前暂不考虑
    - 普通攻击
    - 战技
    - 连携技
    - 终结技
- 技能等级：
    - 可以在选择角色时进行修改，上限为12
    - 技能等级影响技能的一系列动态数据，每个等级对应一组数据映射
        - 技能数据中的部分参数（通常是技能行为中的参数）会填写一个索引key值，此时需要索引到技能等级映射中，对应ID>对应key值，找到当前等级的数据
- 技能持续时间：标识该技能的动作持续时长，关联到时间轴中的显示和互斥释放判断
- 冷却时间：表示多久之后可以再次释放该技能，从技能被释放的时刻开始计算；冷却时间内，放置在时间轴上的同一技能视为无效释放
    - 通常只有连携技有冷却时间，其它技能默认冷却时间为0
- 技力消耗：表示释放技能时需要消耗多少技力，在技能被释放的时刻扣除；技力不足时，放置在时间轴上的技能视为无效释放
    - 通常只有战技有技力消耗，且默认为100；其它技能技力消耗默认为0
- 连携条件：表示技能成功释放是否需要某些特殊前提条件，在技能被释放的时刻判断；关联到释放有效性检查
    - 通常只有连携技需要判断
    - 该条件判断逻辑也会在后续的技能行为执行、技能变体选择时使用，作为一个通用逻辑进行实现
    - 条件包括如下参数
        - 检查类型：
            - 检查目标是否拥有特定buff，提供buffID、比较层数、比较方式，比较方式可以是等于、大于、小于、大于等于、小于等于
            - 检查目标的特定属性，提供属性类型、比较值、比较方式，比较方式可以是等于、大于、小于、大于等于、小于等于
            - 前一段时间内是否执行过特定类型的行为：提供判断时间和行为类型，向前追溯判断时间的时长，判断这段时间内检查目标是否执行过特定行为
                - 判断时间可配置，不配置时默认为4秒
                - 行为类型包括如下这些
                    - 施加buff：检查目标需要在一定时间内施加过特定buff，提供buffID、buff对象（可以检查是否对特定对象添加，为空则不检查）
                    - 获得buff：检查目标需要在一定时间内获得过特定buff，提供buffID、buff来源（可以检查是否由特定对象添加，为空则不检查）
                    - 消耗buff：检查目标需要在一定时间内消耗过特定buff，提供buffID、消耗目标（可以检查是否消耗了特定对象的buff，为空则不检查）
                    - 被消耗buff：检查目标需要在一定时间内被消耗过特定buff，提供buffID、消耗者（可以检查是否由特定对象消耗了buff，为空则不检查）
                    - buff自然结束：检查目标需要在一定时间内自然失去过特定buff（不可以是被消耗），提供buffID
                    - 释放指定类型的技能：检查目标需要在一定时间内释放过特定类型的技能，提供技能类型（普通攻击的重击也算做一种特定类型）
                    - 用指定类型的技能造成过伤害：检查目标需要在一定时间内用特定类型的技能造成过伤害，提供技能类型（普通攻击的重击也算做一种特定类型）
        - 检查目标：在需要目标的检查类型执行时，根据该参数选择目标
            - 自身/自身或队友/其它队友/主控角色/敌人/目标敌人（当前正在攻击的目标敌人）/任意目标（为空即视为任意目标，包括所有角色和敌人）
    - 条件有两种关联方式
        - 直接配置多个条件：多个条件之间按照或的关系进行判断
        - 在一个条件中配置子条件：主条件判断通过后再判断子条件，子条件也需要通过判断才算判断通过，多个子条件之间也为或的关系，任一通过即可；子条件依然可以包含子条件
- 终结技能量消耗：表示释放技能时需要消耗多少终结技能量，在技能被释放的时刻扣除；终结技能量不足时，放置在时间轴上的终结技视为无效释放
    - 只有终结技有该消耗，其它技能默认消耗为0
- 技能行为和效果
    - 即一个技能中具体发生的行为和效果，总的来说是一组打包的数据，根据行为类型和相关参数调用对应的模拟行为
    - 具体包含的数据有
        - 行为类型：标识本次行为对应的具体逻辑
            - 造成伤害：参数为一个伤害倍率，在发生该行为时，需要根据当前的各种角色状态和数据进行一次伤害计算
            - 增加失衡值：参数为一个int值，为目标增加失衡值（通常只能是敌人）
            - 回复自身终结技能量：参数为一个int值，为自身回复相应数量的终结技能量
            - 回复全队终结技：参数为一个int值，为所有队友回复相应数量的终结技能量
            - 回复技力：参数为一个int值，为自身回复相应数量的技力
            - 添加buff：参数为buffID和层数，为目标添加若干个指定buff效果
            - 消耗buff：参数为buffID和层数，从目标上移除若干个指定buff效果
        - 行为目标
            - 自身/自身或队友/其它队友/主控角色/敌人/目标敌人（当前设置为攻击的目标敌人，后续添加该逻辑，目前暂时不用管）/任意目标（为空即视为任意目标，包括所有角色和敌人）
        - 目标数量
            - 按照行为目标筛选一定数量的目标，默认为1；和可用目标数取最小值
        - 行为时间偏移：表示本次行为在技能开始后多久执行；偏移后的时间可以超过技能本身持续时长
        - 行为生效条件：表示本次行为生效需要满足的条件（和连携条件的配置与生效逻辑一致）
    - 行为可以衍生其它行为
        - 主行为成功执行时，才会执行衍生行为
    - 行为可以存在变体
        - 变体必须有生效条件，没有生效条件的变体视为不可被执行
        - 按配置的顺序，优先判断所有变体的生效条件，如果任意一个变体的生效条件生效，则执行该行为，不再判断后续的变体
- 技能变体
    - 技能同样可以存在变体配置，生效逻辑和行为变体相同，只不过技能变体需要拥有完整的技能数据，且生效替换时会替换整个技能（包括持续时间、技能消耗之类的）
        - 当变体生效时，技能时间轴上的显示名称用变体对应的名称，而不是技能本身的名称
    - 技能变体多一个参数：变体条件；必须有该参数，变体条件为空的变体视为不会被执行
        - 变体条件和连携条件的配置与生效逻辑一致；
        - 对于普通攻击的连续攻击，我希望也使用该逻辑进行配置判断，将其作为一种特殊的条件（之前一段时间内释放过普攻，且需要连续计数），也可以考虑使用类似的配置方式，但单独处理条件判断

### 状态（buff）
buff是在进行排轴操作时生成的一种动态效果，它通常由技能行为施加，并在一定时间或是被主动消耗后移除
buff会被添加在某个目标上，可能是角色或敌人

状态的类型大致分为如下几种
- 法术附着、爆发、异常
    - 法术附着是一种持续时间无限的、可叠加层数（最高4层）的状态效果
        - 法术附着本身并没有效果，仅作为一种计数状态存在
    - 法术附着根据伤害属性（灼热、自然、寒冷、电磁），有附加四种不同的附着
        - 灼热附着、自然附着、寒冷附着、电磁附着
    - 当同类型的法术附着叠加时，会触发法术爆发效果，结算一次伤害
        - 伤害计算见下方
    - 当已有某个类型的法术附着后，再次附加非同类型的法术附着时，则会造成法术异常
        - 法术异常也有四种
            - 燃烧：非灼热附着+灼热附着
            - 冻结：非寒冷附着+寒冷附着
                - 冻结持续时间内，如果再次施加破防或其它物理异常，则可消耗本次冻结，触发一次碎冰（算作一种特殊的寒冷异常）
            - 腐蚀：非自然附着+自然附着
            - 导电：非电磁附着+电磁附着
            - 总结而言，即任意一种前置附着+触发附着，则可造成触发附着对应的法术异常（灼热对应燃烧，寒冷对应冻结，自然对应腐蚀，电磁对应导电）
                - 施加异常时，前置附着的层数决定了法术异常的异常等级（最高为4）
        - 法术异常在生效时会根据异常等级结算一次异常伤害，并产生持续一段时间的额外效果
            - 异常伤害计算见下方伤害结算流程中
            - 额外效果的持续时间通常按照基础持续时间计算，但部分技能可能强制添加具有特殊持续时间和异常等级的法术异常
            - 导电的额外效果：持续时间内受到的法术伤害增加（算作通用增益减益中的易伤类型）
                - 根据异常等级，导电带来的易伤倍率分别为12%/16%/20%/24%，初始持续时间为12秒
            - 腐蚀的额外效果：持续时间内角色所有抗性逐渐降低，10秒时达到上限，并且会维持上限；腐蚀的基础持续时间为15秒，如果腐蚀过程中施加新的腐蚀，持续时间会刷新为15秒，并继承已有的减抗叠加数值
                - 根据异常等级，腐蚀的初始减抗数值和随时间提升的额外减抗数值都会增长
                    - 1层：初始3.6，每秒额外减抗0.84，上限12
                    - 2层：初始4.8，每秒额外减抗1.12，上限16
                    - 3层：初始6，每秒额外减抗1.4，上限20
                    - 4层：初始7.2，每秒额外减抗1.68，上限24
            - 燃烧的额外效果：造成持续一段时间的额外伤害（计算见下方）；燃烧的基础持续时间为10秒，如果燃烧过程中施加新的燃烧，持续时间会刷新为10秒，伤害会按照新施加的燃烧伤害进行计算
            - 冻结的额外效果：持续一段时间无法行动（无法行动不用体现，仅计算时间即可）
                - 根据附着层数，冻结的持续时间分别为6/7/8/9秒
- 破防和物理异常
    - 破防是一种持续时间无限的，可叠加层数（最高4层）的状态效果
        - 破防本身并没有效果，仅作为一种计数状态存在
    - 破防通常由物理伤害和物理异常效果添加，也可以由物理异常进行消耗
    - 物理异常有四种，每种物理异常在目标没有破防时都会施加一层破防，如果目标已有破防，则会先造成一次额外伤害，再根据异常类型不同产生不同的效果，具体如下
        - 猛击：如果已有破防，则消耗所有破防层数，根据消耗层数造成伤害
            - 猛击额外伤害倍率 = 150% + 150% * 破防层数
        - 碎甲：如果已有破防，则会消耗所有破防层数，使敌人在一段时间内受到的物理伤害增加（算作通用增益减益中的易伤类型）
            - 碎甲额外伤害倍率 = 50% + 50% * 破防层数
            - 根据消耗的破防层数，碎甲带来的易伤倍率分别为11%/14%/17%/20%，持续时间分别为12/18/24/30秒
        - 击飞/倒地：如果已有破防，则会叠加一层破防，并对敌人积累10点失衡值
            - 击飞/倒地额外伤害倍率 = 120%
- 角色Buff
    - 角色Buff是角色由某些技能添加的特殊状态效果，持续时间和叠加状况由buff本身决定
    - 角色buff可能施加给敌人、也可能施加给队友，来源可能是自身、也可能是队友，通常由添加者管理其生命周期
    - 角色buff通常不会直接产生数值加成，但可能附带具名或通用增益/减益效果，或是影响操作行为（这部分视具体情况，有些可能影响排轴操作）
    - 角色buff通常用于角色技能的触发条件判断，例如
        - 施加xx效果时...
        - 携带xx效果并受到yy效果时...
        - 携带xx效果并受到伤害时...
        - 拥有n层xx效果时...
    - 例如，某些角色的终结技会强制切换主控角色，并强化普攻，此时：
        - 可以视作目标角色被添加了“强制主控”的角色buff
        - 可以视作目标角色被添加了“普攻强化”的角色buff，该角色普攻通常会在开始执行时判断是否具有该buff，并根据判断结果决定执行普通或强化普攻
- 具名增益与减益
    - 具名增益与减益是一类通用的数值类buff，通常影响伤害结算，且持续时间有限
    - 每个具名增益与减益具有一个唯一名称，共享一个乘区
        - 当存在多个角色添加同一名称的该类buff时，buff效果的生效规则取决于每个类型自身的规定(详细内容见后续的具体伤害计算流程)
    - 具名增益与减益的数值和持续时间并不唯一，不同的来源会施加不同数值的同名效果，且每个buff的生命周期由添加者管理，不会相互影响持续时间
        - 同来源的具名增益与减益往往不会叠加生效，而是延长或刷新持续时间
    - 现有的具名增益和和生效方式如下(详细部分见后续的具体伤害计算流程)：
        - 增幅：增加目标造成的伤害，根据增幅的类型可能包括物理增幅、法术增幅、灼热/寒冷/自然/电磁增幅；多个来源的增幅效果会加算
        - 脆弱：增加目标受到的伤害，根据脆弱的类型可能包括物理脆弱、法术脆弱、灼热/寒冷/自然/电磁脆弱；多个来源的脆弱效果会加算
        - 庇护：降低目标受到的所有伤害；多个来源的庇护效果仅取最高值生效
        - 虚弱：降低目标的攻击力；多个来源的虚弱效果累乘生效
        - 连击：增加全队释放的下一个战技或终结技伤害，层数可叠加（最高4层），每层效果分别为30%/45%/60%/75%；任何一个角色释放战技或终结技时都会受到该加成并清空连击层数
- 通用增益与减益
    - 通用增益与减益是完全通用的数值类buff，通常没有特定的名称，按照伤害的基础模块进行分类
        - 通常会将同类型增益或减益效果加总后再进行计算，但也有例外，详见后续的伤害计算逻辑说明
    - 通用增益与减益包括如下类型
        - 伤害加成：造成的伤害增加/减少；通常有一个生效条件（伤害类型、技能类型、目标状态等），满足该条件时，当次伤害适用该加成
        - 易伤加成：使目标受到的伤害增加/减少；通常有一个生效条件（伤害类型、技能类型、目标状态等），满足该条件时，当次伤害适用该加成
        - 伤害减免：使特定类型的伤害直接减免；通常有一个生效条件（伤害类型、技能类型、目标状态等），满足该条件时，当次伤害适用该加成

### 物品
物品是角色可以携带的一类道具，分为消耗品和装备两类
消耗品在使用后提供有一定时间限制的buff效果
装备在携带后会默认影响角色的数值计算，也会存在一些触发式的装备效果
物品没有等级，一个物品的数据永远是静态固定的

- 消耗品不过多解释，整体比较简单，使用后按照持续时间对特定角色产生加成效果即可
    - 通常在战斗过程中（即排轴的中间流程）不可使用消耗品

- 装备
    - 装备分为三个类型：护甲、手套、饰品
    - 每个角色可以携带一个护甲、一个手套、两个饰品
    - 每个装备默认会有若干条静态数值加成，主要是属性（力敏智意）加成，也有部分其它加成效果（造成伤害/攻击力等）；该加成常驻，不会动态变化
    - 装备可能有所属套装（也可能没有），当同一个干员携带3个所属套装相同的装备时，则会激活该套装效果
        - 套装效果通常为静态数值加成或触发类效果，具体效果主要是为目标角色添加buff

### 武器
武器是角色携带的一种特殊物品，它会提供角色基础攻击力加成，并附带1~3个额外加成效果
额外加成效果中包含静态的数值加成，也可能包含部分触发类效果
武器有等级，每个等级对应不同的基础攻击力加成

### 其它相关数据
- 技力
    - 技力是角色释放战技的一种通用属性，所有已选角色消耗同一个技力储量
    - 技力上限为300点，每秒恢复8点，初始为200点
    - 任意技能释放均需要消耗100点技力
    - 部分技能可以恢复技力，恢复量由具体行为节点决定
    - 部分技能可以返还技力，在释放后立刻返还一定量的技力
        - 和恢复的区别在于，返还技力无法触发“技能恢复技力时...”这类的效果
- 失衡
    - 失衡是敌人拥有的一种特殊状态
    - 每个敌人都有特定的失衡值上限，角色的特定行为会为敌人积累失衡值
    - 当失衡值到达上限时，敌人会进入持续一段时间的失衡状态
        - 可以触发敌人失衡时效果
        - 此时伤害结算适用失衡易伤系数
    - 对于某些敌人，存在“踉跄节点”，即失衡值到达特定值时，进入一个短暂的踉跄状态
        - 可以触发敌人踉跄时效果
        - 此时伤害结算不适用失衡易伤系数
- 终结技能量
    - 终结技的释放会消耗终结技能量
    - 不同角色的终结技能量上限不同
    - 终结技能量有基础恢复手段
        - 施放战技消耗技力时，全队获得等量的终结技能量(比例为 6.5 点/ 100 技力)
        - 开始施放连携技时，施放者自身获得终结技能量，该数值默认为 10 点（部分角色可能有特殊恢复值）
    - 部分角色的终结技能量有特殊的恢复手段，在特定角色中具体配置设置
    - 装备中存在“终结技充能效率”，可以等比例增加携带该装备的角色终结技能量恢复
        - 例如，一个角色的终结技充能效率为120%，则原本恢复10点终结技能量的技能现在可以恢复12点
    - 终结技能量满时才可释放终结技，在开始释放时立刻扣除

### 伤害结算
每次技能执行伤害节点时，需要根据该节点的各种伤害相关数值与状态效果，计算当次的伤害值
伤害结算的具体公式如下：
- 单次伤害 = 常规伤害 + 异常和爆发类伤害 + 其它额外伤害
    - 常规伤害 = 基础伤害区* 暴击区* 伤害加成区* 伤害减免区* 易伤区* 增幅区* 庇护区* 脆弱区* 防御区* 失衡易伤区* 减伤区* 抗性区* 非主控减伤区* 特殊加成区
        - 基础伤害区= 伤害倍率* 攻击力* 虚弱区
            - 伤害倍率：即每个伤害行为节点所标识的倍率，通常会由技能提供
            - 攻击力= [(干员基础攻击力+ 武器基础攻击力)* (1+ 百分比加成)+ 固定数值加成]* (1+ 能力值加成)
                - 能力值加成= 主能力* 0.005+ 副能力* 0.002
            - 虚弱区= Π(1- 虚弱效果)
        - 暴击区按照当前角色暴击率，在每次执行时判断是否暴击，存在两种结果
            - 暴击时，暴击区 = 1 + 暴击倍率
            - 未暴击时，暴击区 = 1
            - 展示时，如果角色有暴击率，希望可以选择单次伤害是否固定为暴击或非暴击，或是按照暴击率随机计算
        - 伤害加成区= 1 + 伤害类型伤害加成 + 技能类型伤害加成 + 失衡伤害加成 + 其他伤害加成
            - 所有伤害加成仅在符合条件时生效
            - 例如，一个角色的战技造成了灼热伤害，则它会享受法术伤害加成、灼热伤害加成、战技伤害加成，这几个类型
        - 伤害减免区= 1 - 伤害类型伤害减免
        - 易伤区= 1 + Σ符合条件的易伤
        - 增幅区= 1 + Σ符合条件的增幅效果
        - 庇护区= 1- max(所有庇护效果)
        - 脆弱区= 1+ Σ脆弱效果
        - 防御区存在三种情况
            - 当伤害类型为真实伤害（特殊情况），防御区 = 1
            - 当实际防御力≥0，防御区= 1/( 防御效率系数* 实际防御力+ 1)= 100/( 实际防御力+ 100)
            - 当实际防御力<0，防御区= 2-( 1- 防御效率系数)^( -实际防御力)= 2- 0.99^( -实际防御力)
            - 其中防御效率系数为0.01
            - 角色的基础防御力为0，敌人的基础防御力为100
            - 目前没有对基础防御力进行修改的效果，暂时认为实际防御力 = 基础防御力；但这部分的计算逻辑需要留作可扩展
                - 预计扩展公式为：实际防御力 = 基础防御力 * (1+ 百分比加成) + 固定数值加成
        - 失衡易伤区存在两种情况
            - 当目标不处于失衡状态或无失衡相关参数时，失衡易伤区 = 1
                - 角色没有失衡相关参数
            - 当目标处于失衡状态时
                - 失衡易伤区= 失衡易伤系数
                - 目前失衡易伤系数固定都为1.3
            - 特殊的，当玩家对失衡敌人进行处决时，需要额外计算一个处决承伤系数（仅针对处决这一类型进行该计算，乘算在失衡易伤区中
                - 处决承伤系数取决于敌人具体配置数据
        - 抗性区 = 属性承伤系数+ 抗性降低/ 100- 抗性提升/ 100
            - 属性承伤系数 = (100 - 属性抗性)/100
                - 实际配置数据仅配置属性承伤系数，不用配置属性抗性
            - 目前所有敌人抗性按照物理/灼热/寒冷/自然/电磁拆分为五种，展示上，每个抗性分为D/C/B三个档位（后续还可能扩展A/S档位等），实际计算时还是按照属性承伤数值进行计算
                - D档位：属性承伤系数1，即属性抗性0
                - C档位：属性承伤系数0.8，即属性抗性20（存在少量特殊情况）
                - B档位：属性承伤系数0.5，即属性抗性50
        - 非主控减伤区 = 非主控承伤系数
            - 非主控减伤区是仅针对角色的计算逻辑，玩家对敌人造成伤害时，该值固定为1
            - 非主控承伤系数是敌人属性，绝大多数默认为1，少数有特殊配置
        - 特殊加成区
            - 这里包括了所有特殊的具名增益减益效果中的伤害相关效果，每个名称均为独立乘区，后续可扩展
            - 目前仅有连击属于该类型，即战技或终结技需要计算连击伤害加成
                - 连击伤害加成 = 1 + 连击层数加成
    - 异常和爆发类伤害 = 基础伤害区* 暴击区* 伤害加成区* 伤害减免区* 易伤区* 增幅区* 庇护区* 脆弱区* 防御区* 失衡易伤区* 减伤区* 抗性区* 非主控减伤区* 特殊加成区* 法术等级区* 源石技艺强度区
        - 基础伤害区：和常规伤害基本一致，仅其中的伤害倍率部分不同，取法术/物理异常、法术爆发的伤害倍率进行计算
            - 法术异常伤害倍率
                - 法术爆发伤害倍率 = 160%
                - 法术异常的基础倍率通常受异常等级影响，即触发本次异常前的其它法术附着层数（不包括触发时的这一层）
                    - 例如，敌人已有2层寒冷附着，此时附加电磁附着，则会触发异常等级为2的寒冷异常（冻结）
                - 导电/腐蚀/燃烧基础倍率 = 80% + 80% * 异常等级
                    - 燃烧的每秒持续伤害基础倍率 = 12% + 12% * 异常等级
                - 冻结基础倍率 = 130%
                    - 碎冰(冻结后施加破防或物理异常)基础倍率 = 120% + 120% * 本次冻结的异常等级
                - 除碎冰外，所有法术爆发和法术异常造成的伤害均为对应属性伤害，碎冰造成的是物理伤害
            - 物理异常伤害倍率
                - 猛击伤害倍率 = 150% + 150% * 消耗的破防层数
                - 碎甲伤害倍率 = 50% + 50% * 破防层数
                - 击飞/倒地伤害倍率 = 120%
        - 中间同名区间和常规伤害一直
        - 法术等级区存在两种情况
            - 对于非法术伤害，法术等级区 = 1
            - 对于法术伤害，法术等级 = 1+5/980*(触发法术爆发/异常的角色等级-1)
                - 其中，5/980*(触发法术爆发/异常的角色等级-1)，这部分即为法术等级系数/100（csv中的配置）
        - 源石技艺强度区 = 1+ 源石技艺强度/ 100
            - 源石技艺强度是角色的一个特定属性，基础值为0，仅通过天赋和装备效果提供
    - 其它额外伤害的计算方式和常规伤害一致，只是它通常来源为角色以外的东西（比如装备触发、武器触发），伤害倍率则为本次触发行为标识的伤害倍率

## 网站框架
该工具网站由这几个部分组成
- 左侧选择菜单：负责角色选择、角色信息展示、动态数值调整、物品更换
- 中部排轴操作区域：负责拖放已选角色的技能、进行时间轴排列、选择目标敌人等
- 右侧实时数据计算区域：负责进行已排时间轴相关的数值计算和显示，主要是伤害相关统计

### 左侧边菜单
左侧边菜单需要可以选择角色，并进行信息查看和编辑
角色可以查看和编辑的信息包括如下这些：
- 所有角色属性（可查看）
- 角色等级（可编辑）
- 角色技能等级（可编辑）
- 角色天赋解锁情况（可编辑）
- 角色携带物品（可编辑）
- 角色携带装备（可编辑）
- 角色携带武器（可编辑）
    - 武器等级（可编辑）
    - 武器属性（可查看）
其中，角色等级需要在每次编辑后实时更新计算

### 中部排轴操作区域
排轴操作区域是主要操作区域，包括这些信息显示区域：
- 时间轴区域：一个有刻度的、可以有多个轨道的可拖动的轴，可以在上面放置不同的技能，表示在某个节点执行某个操作
- 启用角色技能区域：四个角色的四种技能按照一个矩阵形式排布出来（相同种类的技能同行排布，同一个角色的技能同列排布；从下到上分别为普通攻击、战技、连携技、终结技）

排轴操作区可以进行如下操作：
1. 点击某个已启用技能，再点击时间轴，可以将该技能放置在鼠标点击的时间轴刻度位置，同一个技能共用一个轴，不同的技能自动新建轴，同角色的技能轴归类排列
    - 每个放置在时间轴上的技能需要按照它的持续时间标识为一个矩形框
        - 需要显示技能名称
        - 需要标识出该技能中包含的每个行为节点
    - 如果添加了buff，需要标识出技能添加的的buff持续时间（所有buff）
        - buff的标识需要和技能行为的有差异
        - 对于无限持续的buff，默认将矩形延长到时间轴的最右侧
        - 可能还包括buff的替换、延长等情况，buff需要标识相关的具体信息
    - 如果消耗了buff，需要标识出消耗的buff类型和层数，并截断被消耗的buff持续时间显示
2. 技能放置后，将根据技能的持续时间、冷却时间、技力消耗、终结技消耗、状态消耗，判断其在放置节点的释放情况，并计算相关数据变化，以及进行自动调整位置和吸附等处理，包括如下这些情况
    - 普通攻击的检测、连击、重击、处决
        - 需要选择某个角色为主控角色，只有主控角色允许拖放普通攻击
        - 当释放普通攻击距离上一次释放普通攻击的时间节点不超过连击间隔时，自动记录连击
        - 连击最后一段时，自动替换为重击，并清空连击记录
        - 敌人处于失衡状态时，自动替换为处决，并清空连击记录
    - 战技释放的成功与否、以及条件替换
        - 当战技拖入时间轴时，需要判断当前节点的技力值是否足够，如果不够，则将该战技置灰
            - 后续再新增允许自动吸附到下一个可释放节点的逻辑
    - 连携技释放成功与否、以及条件替换
        - 当连携技拖入时间轴时，判断该节点是否满足连携技释放条件（触发条件和冷却时间条件），如果不满足，则将该连携技置灰
            - 后续再新增允许自动吸附到下一个可释放节点的逻辑
            - 如果满足连携技释放条件，后续考虑新增自动将该连携技连线到提供释放条件的技能行为节点上
    - 终结技释放成功与否
        - 当终结技拖入时间轴时，需要判断对应角色的终结技能量是否已满，如果不满，则将该终结技置灰
    - 特殊技能的替换
        - 当技能拖入时间轴时，如果有特定条件，检查条件满足时，自动替换为对应的特殊技能
    - 战技、连携技、终结技、普通攻击的自动错开吸附
        - 任何一个战技/连携技/终结技释放过程中，都是无法手动释放其它战技/连携技/终结技/普通攻击的
        - 当技能拖入时间轴时，如果该角色在该时间节点正在释放战技/连携技/终结技，则默认将该技能吸附到正在释放的战技/连携技/终结技结束时
        - 如果拖放的技能释放过程中覆盖了已有的其它战技/连携技/终结技起始节点，则将被覆盖的战技/连携技/终结技自动吸附到本次拖放的技能结束时
        - 吸附后需要触发一次额外检查，判断吸附后的位置是否存在其它互斥现象，如果存在则将相应技能也进行吸附
        - 对于战技，吸附后仍然需要进行技力的相关检查
        - 对于连携技，吸附后仍然需要进行释放条件和冷却时间的相关检查
        - 对于普通攻击，吸附后需要重新更新连击和处决等的相关状态
        ** 增加一个配置，允许开关自动吸附的逻辑，允许将自动吸附改为自动置灰原本需要被自动吸附的技能
3. 按住并拖动已放置在时间轴上的技能，可以调整其位置，松开后重新放置
    - 松开重新放置后需要重新执行所有相关的检查和自动吸附/置灰逻辑
4. 点击技能的右上角按钮，从时间轴上删除该次放置的技能
5. 允许点击技能中的行为节点，查看该节点的角色和敌人buff状态，以及该节点的行为、造成的伤害等信息

### 右侧实时数据计算区域
实时数据计算区域会根据每个技能的释放情况、角色数据，对时间轴上的技能伤害进行计算，并进行记录和展示，包括每个技能释放时的伤害、时间轴某个阶段的总伤害、每秒伤害、每分钟伤害等。